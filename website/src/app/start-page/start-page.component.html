<div class="container">

    <div class="page-header">
        <h1>Documentation<small>&nbsp;&nbsp;generated by <strong>
                <a href="https://github.com/darekf77/ng2-rest">ng2-rest</a>
            </strong> angular 2 lib.</small></h1>
        <br>
        <h2 id="title"> <span>{{msg}}</span> </h2>

        <br>

        <h4 *ngIf="selected && selected.length > 0">{{selected.length}} contracts files to download </h4>
        <div class="list-group" id="download" *ngIf="selected && selected.length > 0"  >
            <a href="#{{ex.group}}" class="list-group-item" *ngFor="let ex of selected">
                <div class="row">
                    <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
                        <h4 class="list-group-item-heading"> {{cuttedUrl(ex)}}</h4>
                        <p class="list-group-item-text">
                            <span class="http-method-{{ex.method}} http-method">{{ex.method}}</span>&nbsp;{{ex.usecase}}
                        </p>
                    </div>
                    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                        <button type="button" class="btn btn-danger pull-right" (click)="ex.isSelected = false; ">-</button>
                    </div>
                </div>
            </a>
        </div>
        <button *ngIf="selected && selected.length > 0" type="button" class="btn btn-success" (click)="downloadAll()">
                <span class="glyphicon glyphicon-cloud-download"></span>
                download all</button>

        <br>
        <br>

        <input type="search" [(ngModel)]="search_model" (ngModelChange)='search($event)' 
        class="form-control" value="" required="required"
            placeholder="Search in docs">



    </div>


    <table class="table table-hover">
        <thead *ngIf="groups && groups.length > 0">
            <tr>
                <th>URL                    
                </th>
                <th class="name">NAME</th>
            </tr>
        </thead>
        <tbody *ngIf="!groups || groups.length === 0">
            <tr>
                <td>
                    Nothing generated
                </td>
            </tr>
        </tbody>
        <tbody *ngFor="let group of groups | searchcontracts:phrase" id="{{group.name}}">
            <tr> <strong>  {{group.name}} </strong>

                <div class="checkbox-in-group" [ngClass]="{'opacityHalf': isGroupPartialSelected(group)}">
                    <label>
                        <input type="checkbox"  [ngModel]="isGroupFullSelected(group) || isGroupPartialSelected(group)" 
                        (change)="groupChange(group,isGroupFullSelected(group))"
                          (click)="$event.stopPropagation()"  >
                    </label>
                </div>
            </tr>
            <tr *ngFor="let file of group.files" (click)="selectFile(file, $event)" [ngClass]="{'activated': (activeFile && activeFile === file) }">
                <td class="url method">{{cuttedUrl(file)}}
                    <div class="checkbox-in-group" [ngClass]="{'opacityHalf': isEndpointPartialSelected(file)}">
                        <label>
                        <input type="checkbox"  [ngModel]="isEndpointFullSelected(file) || isEndpointPartialSelected(file)" 
                        (change)="fileChange(file, isEndpointFullSelected(file) )"  
                          (click)="$event.stopPropagation()"  >
                    </label>
                    </div>

                </td>
                <td class="name">{{file.name}}</td>
                <div class="description" (click)="$event.stopPropagation()" *ngIf="activeFile && activeFile === file">

                    <div class="container">
                        <div>
                            {{activeFile.description}}
                            <br>
                            <br>
                            <br>
                            <div class="list-group">

                                <span class="list-group-item" *ngFor="let ex of file.examples">
                                        <h4 class="list-group-item-heading" (click)="openExample(ex)"  >
                                            <span class="http-method-{{ex.method}} http-method" >{{ex.method}}</span>&nbsp;{{ex.usecase}}
                                <span style="margin-right: 10px;" class="glyphicon glyphicon-menu-down pull-left" *ngIf="!ex.isOpen">
                                                    </span>
                                <span style="margin-right: 10px;" class="glyphicon glyphicon-menu-up pull-left" *ngIf="ex.isOpen">
                                            </span>

                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox"  [(ngModel)]="ex.isSelected"  (click)="$event.stopPropagation()"  >
                                    </label>
                                </div>

                                </h4>
                                <hr *ngIf="ex.isOpen">


                                <tabset type="pills" class="common-tabs" *ngIf="ex.isOpen">
                                    <tab heading="Usecase">

                                        <p *ngIf="ex.isOpen && ex.urlFull" class="list-group-item-text">
                                            <strong>Full request url:</strong> {{ex.urlFull}} <br>
                                        </p>
                                        <p *ngIf="ex.isOpen && ex.urlParams" class="list-group-item-text">
                                            <strong>Url params: </strong> <code>{{ex.urlParams}}</code> <br>
                                        </p>
                                        <p *ngIf="ex.isOpen && ex.bodySend" class="list-group-item-text">
                                            Request body: <br>
                                            <code>
                                                                {{ex.bodySend}}
                                                            </code>
                                        </p>
                                        <p *ngIf="ex.isOpen && ex.bodyRecieve" class="list-group-item-text">
                                            Received data: <br>
                                            <code>
                                                                {{ex.bodyRecieve}}
                                                            </code>
                                        </p>

                                    </tab>
                                    <tab heading="Contract">

                                        <button type="button" *ngIf="ex.isOpen && ex.contract" (click)="copy(ex)" class="btn btn-default copy-button">Copy to clipboard</button>

                                        <pre *ngIf="ex.isOpen && ex.contract">
                                            <code highlight class="groovy"> {{removeReturn(ex.contract)}} </code>
                                        </pre>

                                        <span *ngIf="ex.isOpen && !ex.contract" class="label label-danger">
                                                    No generated contract for usecase
                                                </span>

                                    </tab>
                                </tabset>


                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </tr>
        </tbody>
    </table>

</div>
